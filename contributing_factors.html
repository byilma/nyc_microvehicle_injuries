<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />



<meta name="date" content="2020-11-21" />

<title>Contributing Factors</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.5.2/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-1.52.2/plotly-latest.min.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="mailto:&lt;you@youremail.com&gt;">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/byilma/nyc_microvehicle_injuries">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Contributing Factors</h1>
<h4 class="date">11/21/2020</h4>

</div>


<p><br></br></p>
<div id="description" class="section level2">
<h2>Description</h2>
<p>The goal of these analyses is to understand whether there have been changes in contributing factors of bike and microvehicle crashes during the COVID-19 pandemic as compared to prior to the pandemic. We hypothesized that there would be changes in contributing factors due to changes in traffic patterns as a result of the pandemic. For example, as many businesses have transitioned to remote work, city streets may become less congested with cars, which could result in increased speeding or other unsafe driving behaviors. In addition, as many healthcare workers were offered free CITI bike memberships during the pandemic, there may have been an increase in the number of new bike riders, who may have less riding experience and be more prone to bike riding errors.</p>
<p>The NYC Department of Transportation Motor Vehicle Collisions - Crashes data contain a contributing factor variable that is designated for each vehicle involved in the collision. These contributing factors are recorded on the police accident report by the crash investigator, who is responsible for determining the apparent reason for the collision. Contributing factors include options like aggressive driving, failure to yield right-of-way, unsafe speed, and bicyclist error/confusion.</p>
<p><br></br></p>
</div>
<div id="top-contributing-factors-for-bike-crashes" class="section level2">
<h2>Top Contributing Factors for Bike Crashes</h2>
<p>In this first analysis, we compared the top ten contributing factors in bike crashes pre- and during COVID-19. We subset the collision data to crashes involving a bike where a cyclist was injured. Since we are making comparisons pre- and during the pandemic, We further restricted the data to crashes occurring in March through October to control for potential seasonal effects. Crashes that occurred pre-2020 were classified as pre-COVID and crashes that occurred in 2020 were classified as during COVID. Contributing factors were summarized as the proportion of collisions that involved the given factor. Since multiple contributing factors can be recorded for each collision, these proportions will not sum to 100%.</p>
<pre class="r"><code>bikes = 
  read_csv(&quot;./data/crash_dat.csv&quot;) %&gt;%
  filter_for(&quot;bike&quot;) %&gt;%
  filter(
    month %in% (3:10),
    number_of_cyclist_injured &gt; 0
    ) %&gt;%
  separate(crash_time, into = c(&quot;hour&quot;, &quot;minute&quot;, &quot;second&quot;), sep = &quot;:&quot;) %&gt;%
  mutate(
    covid = as.factor(if_else(year &lt; 2020, &#39;Pre-COVID&#39;, &#39;COVID&#39;)),
    vehicle_number = str_extract_all(vehicle_number, &quot;\\d&quot;, simplify = TRUE),
    covid = fct_relevel(covid, &#39;Pre-COVID&#39;),
    dow = fct_relevel(dow, &quot;Sunday&quot;, &quot;Saturday&quot;, &quot;Friday&quot;, &quot;Thursday&quot;, &quot;Wednesday&quot;, &quot;Tuesday&quot;)
  ) 


bike_factor = 
  bikes %&gt;%
  pivot_longer(
    contributing_factor_vehicle_1:contributing_factor_vehicle_5,
    names_to = &quot;vehicle_factor_num&quot;,
    names_prefix = &quot;contributing_factor_vehicle_&quot;,
    values_to = &quot;contributing_factor&quot;
   ) %&gt;%
  mutate(
    contributing_factor = if_else(contributing_factor == &quot;Pedestrian/Bicyclist/Other Pedestrian Error/Confusion&quot;, &quot;Pedestrian/Cyclist Error&quot;, contributing_factor)
  ) %&gt;%
  group_by(covid, contributing_factor) %&gt;%
  summarise(
    collisions = n_distinct(collision_id)
  ) %&gt;%
  drop_na(contributing_factor) %&gt;%
  ungroup(contributing_factor) %&gt;%
  filter(contributing_factor != &quot;Unspecified&quot;) %&gt;%
  mutate(
    covid = fct_relevel(covid, &#39;Pre-COVID&#39;),
    proportion = round(collisions / sum(collisions), 2) 
  ) 
  

top_10_bike = 
  bike_factor %&gt;%
  group_by(covid) %&gt;%
  top_n(n = 10, wt = proportion) %&gt;%
  mutate(
    contributing_factor = fct_reorder(as.factor(contributing_factor), collisions, .desc = TRUE)
  ) %&gt;%
  ggplot(aes(x = contributing_factor, y = proportion, fill = covid)) +
  geom_bar(stat = &quot;identity&quot;) +
  facet_grid( . ~covid, scales = &quot;free_x&quot;, space = &quot;free_x&quot;) +
  scale_y_continuous(labels = scales::percent) +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1), legend.position = &quot;none&quot;) +
  labs(
    title = &quot;Top Ten Contributing Factors for Crashes Involving Injuries to Cyclists&quot;,
    x = &quot;&quot;,
    y = &quot;&quot;
  )

ggplotly(top_10_bike, tooltip = c(&quot;x&quot;, &quot;y&quot;)) </code></pre>
<div id="htmlwidget-024ce9d9b8d35e05f94a" style="width:768px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-024ce9d9b8d35e05f94a">{"x":{"data":[{"orientation":"v","width":[0.9,0.899999999999999,0.9,0.9,0.899999999999999,0.899999999999999,0.9,0.9,0.9,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999],"base":[0,0,0,0,0,0,0,0,0,0,0,0,0,0],"x":[1,9,3,6,8,13,5,7,2,4,10,14,11,12],"y":[0.33,0.02,0.14,0.03,0.02,0.02,0.06,0.03,0.15,0.06,0.02,0.02,0.02,0.02],"text":["contributing_factor: Driver Inattention/Distraction<br />proportion: 0.33","contributing_factor: Driver Inexperience<br />proportion: 0.02","contributing_factor: Failure to Yield Right-of-Way<br />proportion: 0.14","contributing_factor: Following Too Closely<br />proportion: 0.03","contributing_factor: Other Vehicular<br />proportion: 0.02","contributing_factor: Passenger Distraction<br />proportion: 0.02","contributing_factor: Passing or Lane Usage Improper<br />proportion: 0.06","contributing_factor: Passing Too Closely<br />proportion: 0.03","contributing_factor: Pedestrian/Cyclist Error<br />proportion: 0.15","contributing_factor: Traffic Control Disregarded<br />proportion: 0.06","contributing_factor: Turning Improperly<br />proportion: 0.02","contributing_factor: Unsafe Lane Changing<br />proportion: 0.02","contributing_factor: Unsafe Speed<br />proportion: 0.02","contributing_factor: View Obstructed/Limited<br />proportion: 0.02"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(68,1,84,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Pre-COVID","legendgroup":"Pre-COVID","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.899999999999999,0.9,0.9,0.899999999999999,0.9,0.9,0.9,0.9,0.899999999999999,0.899999999999999,0.899999999999999],"base":[0,0,0,0,0,0,0,0,0,0,0,0],"x":[1,9,3,6,8,5,7,2,4,10,11,12],"y":[0.37,0.02,0.15,0.03,0.03,0.06,0.02,0.12,0.07,0.02,0.02,0.02],"text":["contributing_factor: Driver Inattention/Distraction<br />proportion: 0.37","contributing_factor: Driver Inexperience<br />proportion: 0.02","contributing_factor: Failure to Yield Right-of-Way<br />proportion: 0.15","contributing_factor: Following Too Closely<br />proportion: 0.03","contributing_factor: Other Vehicular<br />proportion: 0.03","contributing_factor: Passing or Lane Usage Improper<br />proportion: 0.06","contributing_factor: Passing Too Closely<br />proportion: 0.02","contributing_factor: Pedestrian/Cyclist Error<br />proportion: 0.12","contributing_factor: Traffic Control Disregarded<br />proportion: 0.07","contributing_factor: Turning Improperly<br />proportion: 0.02","contributing_factor: Unsafe Speed<br />proportion: 0.02","contributing_factor: View Obstructed/Limited<br />proportion: 0.02"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(253,231,37,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"COVID","legendgroup":"COVID","showlegend":true,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":56.9132420091324,"r":18.9954337899543,"b":107.658183329002,"l":28.4931506849315},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Top Ten Contributing Factors for Crashes Involving Injuries to Cyclists","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,0.490487062404871],"automargin":true,"type":"linear","autorange":false,"range":[0.4,14.6],"tickmode":"array","ticktext":["Driver Inattention/Distraction","Pedestrian/Cyclist Error","Failure to Yield Right-of-Way","Traffic Control Disregarded","Passing or Lane Usage Improper","Following Too Closely","Passing Too Closely","Other Vehicular","Driver Inexperience","Turning Improperly","Unsafe Speed","View Obstructed/Limited","Passenger Distraction","Unsafe Lane Changing"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14],"categoryorder":"array","categoryarray":["Driver Inattention/Distraction","Pedestrian/Cyclist Error","Failure to Yield Right-of-Way","Traffic Control Disregarded","Passing or Lane Usage Improper","Following Too Closely","Passing Too Closely","Other Vehicular","Driver Inexperience","Turning Improperly","Unsafe Speed","View Obstructed/Limited","Passenger Distraction","Unsafe Lane Changing"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-45,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":"","hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.0185,0.3885],"tickmode":"array","ticktext":["0%","10%","20%","30%"],"tickvals":[0,0.1,0.2,0.3],"categoryorder":"array","categoryarray":["0%","10%","20%","30%"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.490487062404871,"y0":0,"y1":1},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.490487062404871,"y0":0,"y1":23.37899543379,"yanchor":1,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.509512937595129,"x1":1,"y0":0,"y1":1},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.509512937595129,"x1":1,"y0":0,"y1":23.37899543379,"yanchor":1,"ysizemode":"pixel"}],"annotations":[{"text":"Pre-COVID","x":0.245243531202435,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"COVID","x":0.754756468797565,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"}],"xaxis2":{"type":"linear","autorange":false,"range":[0.4,12.6],"tickmode":"array","ticktext":["Driver Inattention/Distraction","Pedestrian/Cyclist Error","Failure to Yield Right-of-Way","Traffic Control Disregarded","Passing or Lane Usage Improper","Following Too Closely","Passing Too Closely","Other Vehicular","Driver Inexperience","Turning Improperly","Unsafe Speed","View Obstructed/Limited"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12],"categoryorder":"array","categoryarray":["Driver Inattention/Distraction","Pedestrian/Cyclist Error","Failure to Yield Right-of-Way","Traffic Control Disregarded","Passing or Lane Usage Improper","Following Too Closely","Passing Too Closely","Other Vehicular","Driver Inexperience","Turning Improperly","Unsafe Speed","View Obstructed/Limited"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-45,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.509512937595129,1],"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":"","hoverformat":".2f"},"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"45970323693":{"x":{},"y":{},"fill":{},"type":"bar"}},"cur_data":"45970323693","visdat":{"45970323693":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>As seen in this plot, the leading contributing factor for bike crashes involving cyclist injuries was driver inattention or distraction both pre- and during the pandemic. However, the proportion of crashes with driver inattention listed as a contributing factor increased from 33% pre-pandemic to 37% during the pandemic. Similarly, there was a slight decrease in the proportion of bike crashes involving cyclist error during the pandemic, with 15% of crashes having this listed as a contributing factor pre-pandemic as compared to 12% during the pandemic.</p>
<p><br></br></p>
</div>
<div id="top-contributing-factors-for-microvehicle-crashes" class="section level2">
<h2>Top Contributing Factors for Microvehicle Crashes</h2>
<p>The following analysis replicates the analysis above for microvehicle crashes involving an injury.</p>
<pre class="r"><code>microveh = 
  read_csv(&quot;./data/crash_dat.csv&quot;) %&gt;%
  filter_for(&quot;micro&quot;) %&gt;%
  filter(
    month %in% (3:10),
    number_of_persons_injured &gt; 0
    ) %&gt;%
  separate(crash_time, into = c(&quot;hour&quot;, &quot;minute&quot;, &quot;second&quot;), sep = &quot;:&quot;) %&gt;%
  mutate(
    covid = as.factor(if_else(year &lt; 2020, &#39;Pre-COVID&#39;, &#39;COVID&#39;)),
    vehicle_number = str_extract_all(vehicle_number, &quot;\\d&quot;, simplify = TRUE),
    covid = fct_relevel(covid, &#39;Pre-COVID&#39;),
    dow = fct_relevel(dow, &quot;Sunday&quot;, &quot;Saturday&quot;, &quot;Friday&quot;, &quot;Thursday&quot;, &quot;Wednesday&quot;, &quot;Tuesday&quot;)
  ) 

micro_factor = 
  microveh %&gt;%
  pivot_longer(
    contributing_factor_vehicle_1:contributing_factor_vehicle_5,
    names_to = &quot;vehicle_factor_num&quot;,
    names_prefix = &quot;contributing_factor_vehicle_&quot;,
    values_to = &quot;contributing_factor&quot;
   ) %&gt;%
  mutate(
    contributing_factor = if_else(contributing_factor == &quot;Pedestrian/Bicyclist/Other Pedestrian Error/Confusion&quot;, &quot;Pedestrian/Cyclist Error&quot;, contributing_factor)
  ) %&gt;%
  group_by(covid, contributing_factor) %&gt;%
  summarise(
    collisions = n_distinct(collision_id)
  ) %&gt;%
  drop_na(contributing_factor) %&gt;%
  ungroup(contributing_factor) %&gt;%
  filter(contributing_factor != &quot;Unspecified&quot;) %&gt;%
  mutate(
    covid = fct_relevel(covid, &#39;Pre-COVID&#39;),
    proportion = round(collisions / sum(collisions), 2) 
  ) 
  

top_10_micro = 
  micro_factor %&gt;%
  group_by(covid) %&gt;%
  top_n(n = 10, wt = proportion) %&gt;%
  mutate(
    contributing_factor = fct_reorder(as.factor(contributing_factor), collisions, .desc = TRUE)
  ) %&gt;%
  ggplot(aes(x = contributing_factor, y = proportion, fill = covid)) +
  geom_bar(stat = &quot;identity&quot;) +
  facet_grid( . ~covid, scales = &quot;free_x&quot;, space = &quot;free_x&quot;) +
  scale_y_continuous(labels = scales::percent) +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1), legend.position = &quot;none&quot;) +
  labs(
    title = &quot;Top Ten Contributing Factors for Microvehicle Crashes Involving Injuries&quot;,
    x = &quot;&quot;,
    y = &quot;&quot;
  )

ggplotly(top_10_micro, tooltip = c(&quot;x&quot;, &quot;y&quot;)) </code></pre>
<div id="htmlwidget-7fabb0e643947cd1c20d" style="width:768px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-7fabb0e643947cd1c20d">{"x":{"data":[{"orientation":"v","width":[0.9,0.9,0.9,0.899999999999999,0.9,0.9,0.899999999999999,0.899999999999999,0.9,0.899999999999999,0.899999999999999,0.9,0.899999999999999],"base":[0,0,0,0,0,0,0,0,0,0,0,0,0],"x":[1,5,2,9,7,4,13,8,3,11,10,6,12],"y":[0.37,0.06,0.11,0.02,0.04,0.08,0.02,0.04,0.09,0.02,0.02,0.04,0.02],"text":["contributing_factor: Driver Inattention/Distraction<br />proportion: 0.37","contributing_factor: Driver Inexperience<br />proportion: 0.06","contributing_factor: Failure to Yield Right-of-Way<br />proportion: 0.11","contributing_factor: Following Too Closely<br />proportion: 0.02","contributing_factor: Other Vehicular<br />proportion: 0.04","contributing_factor: Passing or Lane Usage Improper<br />proportion: 0.08","contributing_factor: Passing Too Closely<br />proportion: 0.02","contributing_factor: Pedestrian/Cyclist Error<br />proportion: 0.04","contributing_factor: Traffic Control Disregarded<br />proportion: 0.09","contributing_factor: Turning Improperly<br />proportion: 0.02","contributing_factor: Unsafe Lane Changing<br />proportion: 0.02","contributing_factor: Unsafe Speed<br />proportion: 0.04","contributing_factor: View Obstructed/Limited<br />proportion: 0.02"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(68,1,84,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Pre-COVID","legendgroup":"Pre-COVID","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9,0.899999999999999,0.9,0.9,0.899999999999999,0.9,0.899999999999999,0.9],"base":[0,0,0,0,0,0,0,0,0,0],"x":[1,5,2,9,7,4,8,3,10,6],"y":[0.37,0.04,0.13,0.04,0.04,0.07,0.04,0.08,0.03,0.05],"text":["contributing_factor: Driver Inattention/Distraction<br />proportion: 0.37","contributing_factor: Driver Inexperience<br />proportion: 0.04","contributing_factor: Failure to Yield Right-of-Way<br />proportion: 0.13","contributing_factor: Following Too Closely<br />proportion: 0.04","contributing_factor: Other Vehicular<br />proportion: 0.04","contributing_factor: Passing or Lane Usage Improper<br />proportion: 0.07","contributing_factor: Pedestrian/Cyclist Error<br />proportion: 0.04","contributing_factor: Traffic Control Disregarded<br />proportion: 0.08","contributing_factor: Turning Improperly<br />proportion: 0.03","contributing_factor: Unsafe Speed<br />proportion: 0.05"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(253,231,37,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"COVID","legendgroup":"COVID","showlegend":true,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":56.9132420091324,"r":18.9954337899543,"b":107.658183329002,"l":28.4931506849315},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Top Ten Contributing Factors for Microvehicle Crashes Involving Injuries","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,0.490487062404871],"automargin":true,"type":"linear","autorange":false,"range":[0.4,13.6],"tickmode":"array","ticktext":["Driver Inattention/Distraction","Failure to Yield Right-of-Way","Traffic Control Disregarded","Passing or Lane Usage Improper","Driver Inexperience","Unsafe Speed","Other Vehicular","Pedestrian/Cyclist Error","Following Too Closely","Unsafe Lane Changing","Turning Improperly","View Obstructed/Limited","Passing Too Closely"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13],"categoryorder":"array","categoryarray":["Driver Inattention/Distraction","Failure to Yield Right-of-Way","Traffic Control Disregarded","Passing or Lane Usage Improper","Driver Inexperience","Unsafe Speed","Other Vehicular","Pedestrian/Cyclist Error","Following Too Closely","Unsafe Lane Changing","Turning Improperly","View Obstructed/Limited","Passing Too Closely"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-45,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":"","hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.0185,0.3885],"tickmode":"array","ticktext":["0%","10%","20%","30%"],"tickvals":[0,0.1,0.2,0.3],"categoryorder":"array","categoryarray":["0%","10%","20%","30%"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.490487062404871,"y0":0,"y1":1},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.490487062404871,"y0":0,"y1":23.37899543379,"yanchor":1,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.509512937595129,"x1":1,"y0":0,"y1":1},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.509512937595129,"x1":1,"y0":0,"y1":23.37899543379,"yanchor":1,"ysizemode":"pixel"}],"annotations":[{"text":"Pre-COVID","x":0.245243531202435,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"COVID","x":0.754756468797565,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"}],"xaxis2":{"type":"linear","autorange":false,"range":[0.4,10.6],"tickmode":"array","ticktext":["Driver Inattention/Distraction","Failure to Yield Right-of-Way","Traffic Control Disregarded","Passing or Lane Usage Improper","Driver Inexperience","Unsafe Speed","Other Vehicular","Pedestrian/Cyclist Error","Following Too Closely","Turning Improperly"],"tickvals":[1,2,3,4,5,6,7,8,9,10],"categoryorder":"array","categoryarray":["Driver Inattention/Distraction","Failure to Yield Right-of-Way","Traffic Control Disregarded","Passing or Lane Usage Improper","Driver Inexperience","Unsafe Speed","Other Vehicular","Pedestrian/Cyclist Error","Following Too Closely","Turning Improperly"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-45,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.509512937595129,1],"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":"","hoverformat":".2f"},"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"4595a304a83":{"x":{},"y":{},"fill":{},"type":"bar"}},"cur_data":"4595a304a83","visdat":{"4595a304a83":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>As seen in the bike analysis, the leading contributing factor for microvehicle crashes involving injuries was driver inattention or distraction both pre- and during the pandemic, with 37% of crashes involving this factor at both time periods. Differences in contributing factors in these microvehicle crashes were minor.</p>
<p><br></br></p>
</div>
<div id="temporal-heat-maps-for-bike-crashes" class="section level2">
<h2>Temporal Heat Maps for Bike Crashes</h2>
<p>In addition to the contributing factors listed on the crash report, collisions are often observed to cluster by time of day and day of week. For example, crashes tend to cluster during weekdays at rush hour, when more cars are on the road. Since many individuals are no longer commuting to work, it’s possible that this clustering will have changed during the pandemic. We therefore explored whether this clustering by time of day and day of week changed pre-pandemic versus during the pandemic.</p>
<p>To accomplish this, we created a heat map of bike crashes involving a cyclist injury by time of day and day of week pre and during COVID.</p>
<pre class="r"><code>heat_maps = function(dataset, title) {
  pre = 
  dataset %&gt;%
  filter(covid == &quot;Pre-COVID&quot;) %&gt;%
  plot_ly(
    x = ~hour, y = ~dow, z = ~collisions, type = &quot;heatmap&quot;, colors = &quot;BuPu&quot;
  ) %&gt;%
  colorbar(title = &quot;Pre-COVID&quot;, x = 1, y = 1) 

covid = 
  dataset %&gt;%
  filter(covid == &quot;COVID&quot;) %&gt;%
  plot_ly(
    x = ~hour, y = ~dow, z = ~collisions, type = &quot;heatmap&quot;, colors = &quot;YlGn&quot;
  ) %&gt;%
  colorbar(title = &quot;COVID&quot;, x = 1, y = 0.5) 

subplot(pre, covid, nrows = 2, margin = .05) %&gt;%
  layout(title = title)
}

crash_day_time = 
  bikes %&gt;%
  group_by(covid, hour, dow) %&gt;%
  summarise(
    collisions = n_distinct(collision_id)
  )  

heat_maps(dataset = crash_day_time, title = &quot;Heat Maps of Bike Crashes&quot;)</code></pre>
<div id="htmlwidget-d39478298dff0e120d17" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-d39478298dff0e120d17">{"x":{"data":[{"colorbar":{"title":"Pre-COVID","ticklen":2,"len":0.333333333333333,"lenmode":"fraction","y":1,"yanchor":"top","x":1},"colorscale":[["0","rgba(247,252,253,1)"],["0.0416666666666667","rgba(239,247,250,1)"],["0.0833333333333333","rgba(232,241,247,1)"],["0.125","rgba(224,236,244,1)"],["0.166666666666667","rgba(213,228,239,1)"],["0.208333333333333","rgba(202,219,235,1)"],["0.25","rgba(191,211,230,1)"],["0.291666666666667","rgba(180,203,226,1)"],["0.333333333333333","rgba(169,196,222,1)"],["0.375","rgba(158,188,218,1)"],["0.416666666666667","rgba(152,175,211,1)"],["0.458333333333333","rgba(146,163,205,1)"],["0.5","rgba(140,150,198,1)"],["0.541666666666667","rgba(141,136,191,1)"],["0.583333333333333","rgba(141,122,184,1)"],["0.625","rgba(140,107,177,1)"],["0.666666666666667","rgba(139,94,170,1)"],["0.708333333333333","rgba(138,80,164,1)"],["0.75","rgba(136,65,157,1)"],["0.791666666666667","rgba(134,52,146,1)"],["0.833333333333333","rgba(132,36,135,1)"],["0.875","rgba(129,15,124,1)"],["0.916666666666667","rgba(111,8,107,1)"],["0.958333333333333","rgba(94,3,91,1)"],["1","rgba(77,0,75,1)"]],"showscale":true,"x":["00","00","00","00","00","00","00","01","01","01","01","01","01","01","02","02","02","02","02","02","02","03","03","03","03","03","03","03","04","04","04","04","04","04","04","05","05","05","05","05","05","05","06","06","06","06","06","06","06","07","07","07","07","07","07","07","08","08","08","08","08","08","08","09","09","09","09","09","09","09","10","10","10","10","10","10","10","11","11","11","11","11","11","11","12","12","12","12","12","12","12","13","13","13","13","13","13","13","14","14","14","14","14","14","14","15","15","15","15","15","15","15","16","16","16","16","16","16","16","17","17","17","17","17","17","17","18","18","18","18","18","18","18","19","19","19","19","19","19","19","20","20","20","20","20","20","20","21","21","21","21","21","21","21","22","22","22","22","22","22","22","23","23","23","23","23","23","23"],"y":["Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday"],"z":[54,71,55,60,40,40,50,28,27,26,10,12,10,14,16,21,16,16,13,7,7,13,16,7,5,5,3,4,12,24,8,8,8,4,10,10,9,8,12,8,10,15,9,7,26,28,30,22,21,14,18,45,34,54,55,29,23,28,64,74,81,88,65,34,50,77,78,61,94,68,45,61,63,75,59,79,51,56,79,88,68,63,58,55,75,105,74,76,72,65,78,102,94,98,68,98,84,73,125,117,112,86,103,92,87,106,103,110,119,111,104,102,116,112,129,102,105,127,122,102,101,140,144,134,167,131,108,107,138,124,138,133,127,110,99,132,120,108,134,105,99,89,120,106,100,103,87,91,95,81,85,89,93,88,62,80,85,73,60,66,61,31,55,56,52,47,48,42],"type":"heatmap","xaxis":"x","yaxis":"y","frame":null},{"colorbar":{"title":"COVID","ticklen":2,"len":0.333333333333333,"lenmode":"fraction","y":0.5,"yanchor":"top","x":1},"colorscale":[["0","rgba(255,255,229,1)"],["0.0416666666666667","rgba(253,254,214,1)"],["0.0833333333333333","rgba(250,253,200,1)"],["0.125","rgba(247,252,185,1)"],["0.166666666666667","rgba(237,248,178,1)"],["0.208333333333333","rgba(227,244,170,1)"],["0.25","rgba(217,240,163,1)"],["0.291666666666667","rgba(202,234,156,1)"],["0.333333333333333","rgba(188,227,149,1)"],["0.375","rgba(173,221,142,1)"],["0.416666666666667","rgba(156,213,135,1)"],["0.458333333333333","rgba(138,206,128,1)"],["0.5","rgba(120,198,121,1)"],["0.541666666666667","rgba(103,189,112,1)"],["0.583333333333333","rgba(85,180,102,1)"],["0.625","rgba(65,171,93,1)"],["0.666666666666667","rgba(55,158,84,1)"],["0.708333333333333","rgba(45,145,76,1)"],["0.75","rgba(35,132,67,1)"],["0.791666666666667","rgba(26,123,63,1)"],["0.833333333333333","rgba(14,113,59,1)"],["0.875","rgba(0,104,55,1)"],["0.916666666666667","rgba(0,92,50,1)"],["0.958333333333333","rgba(0,80,46,1)"],["1","rgba(0,69,41,1)"]],"showscale":true,"x":["00","00","00","00","00","00","00","01","01","01","01","01","01","01","02","02","02","02","02","02","02","03","03","03","03","03","03","03","04","04","04","04","04","05","05","05","05","05","05","06","06","06","06","06","06","06","07","07","07","07","07","07","07","08","08","08","08","08","08","08","09","09","09","09","09","09","09","10","10","10","10","10","10","10","11","11","11","11","11","11","11","12","12","12","12","12","12","12","13","13","13","13","13","13","13","14","14","14","14","14","14","14","15","15","15","15","15","15","15","16","16","16","16","16","16","16","17","17","17","17","17","17","17","18","18","18","18","18","18","18","19","19","19","19","19","19","19","20","20","20","20","20","20","20","21","21","21","21","21","21","21","22","22","22","22","22","22","22","23","23","23","23","23","23","23"],"y":["Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Sunday","Saturday","Friday","Thursday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday"],"z":[11,14,21,15,13,12,14,8,4,4,4,3,2,3,6,2,4,4,2,4,2,10,5,4,2,1,3,2,5,2,3,1,1,3,3,6,2,5,5,3,4,6,9,4,8,5,4,7,14,13,13,6,12,6,6,13,17,21,20,10,7,10,14,11,21,18,14,11,11,16,19,12,12,13,23,24,18,21,15,15,13,20,17,21,29,21,29,21,30,26,27,34,25,20,22,33,34,29,22,28,25,22,25,36,30,29,24,20,34,41,47,41,51,42,37,35,32,27,46,51,48,43,44,36,41,46,39,35,38,38,23,33,38,36,46,34,25,32,35,34,34,23,37,20,23,26,23,27,18,22,24,21,26,23,15,31,13,6,17,19,21,13,13,8,10],"type":"heatmap","xaxis":"x2","yaxis":"y2","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"type":"category","categoryorder":"array","categoryarray":["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"],"anchor":"y"},"xaxis2":{"domain":[0,1],"automargin":true,"type":"category","categoryorder":"array","categoryarray":["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"],"anchor":"y2"},"yaxis2":{"domain":[0,0.45],"automargin":true,"type":"category","categoryorder":"array","categoryarray":["Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday"],"anchor":"x2"},"yaxis":{"domain":[0.55,1],"automargin":true,"type":"category","categoryorder":"array","categoryarray":["Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday"],"anchor":"x"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"zaxis":{"title":"collisions"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.333333333333333},"title":"Heat Maps of Bike Crashes"},"attrs":{"4595db6cee7":{"x":{},"y":{},"z":{},"colors":"BuPu","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"heatmap"},"459cc9cfc2":{"x":{},"y":{},"z":{},"colors":"YlGn","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"heatmap"}},"source":"A","config":{"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>As seen in this plot, there was a similar trend pre- and during COVID, where the majority of bike crashes are clustered in the evening hours. There did seem to be slightly more clustering in the evening rush hour times of 4-6 PM during COVID as compared to pre-COVID. In addition, there was slightly less clustering in the morning hours during COVID.</p>
<p><br></br></p>
<div id="heat-maps-for-crashes-involving-cyclist-contributing-factors" class="section level3">
<h3>Heat Maps for Crashes Involving Cyclist Contributing Factors</h3>
<p>In next analysis, we further explored clustering by time of day and day of week based on whether the crash had a contributing factor attributed to the cyclist, which was defined as either having a factor of cyclist error or a valid factor with the same vehicle number as the bike vehicle number.</p>
<pre class="r"><code>day_time_bike_err = 
  bikes %&gt;%
  pivot_longer(
    contributing_factor_vehicle_1:contributing_factor_vehicle_5,
    names_to = &quot;vehicle_factor_num&quot;,
    names_prefix = &quot;contributing_factor_vehicle_&quot;,
    values_to = &quot;contributing_factor&quot;
   ) %&gt;%
  filter((contributing_factor == &quot;Pedestrian/Cyclist Error&quot; |
           vehicle_factor_num == vehicle_number),
         contributing_factor != &quot;Unspecified&quot;) %&gt;%
  group_by(covid, hour, dow) %&gt;%
  summarise(
    collisions = n_distinct(collision_id)
  )

heat_maps(dataset = day_time_bike_err, title = &quot;Heat Maps of Bike Crashes Involving Cyclist Factors&quot;)</code></pre>
<div id="htmlwidget-71206d3c25f7097d1cec" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-71206d3c25f7097d1cec">{"x":{"data":[{"colorbar":{"title":"Pre-COVID","ticklen":2,"len":0.333333333333333,"lenmode":"fraction","y":1,"yanchor":"top","x":1},"colorscale":[["0","rgba(247,252,253,1)"],["0.0416666666666667","rgba(239,247,250,1)"],["0.0833333333333333","rgba(232,241,247,1)"],["0.125","rgba(224,236,244,1)"],["0.166666666666667","rgba(213,228,239,1)"],["0.208333333333333","rgba(202,219,235,1)"],["0.25","rgba(191,211,230,1)"],["0.291666666666667","rgba(180,203,226,1)"],["0.333333333333333","rgba(169,196,222,1)"],["0.375","rgba(158,188,218,1)"],["0.416666666666667","rgba(152,175,211,1)"],["0.458333333333333","rgba(146,163,205,1)"],["0.5","rgba(140,150,198,1)"],["0.541666666666667","rgba(141,136,191,1)"],["0.583333333333333","rgba(141,122,184,1)"],["0.625","rgba(140,107,177,1)"],["0.666666666666667","rgba(139,94,170,1)"],["0.708333333333333","rgba(138,80,164,1)"],["0.75","rgba(136,65,157,1)"],["0.791666666666667","rgba(134,52,146,1)"],["0.833333333333333","rgba(132,36,135,1)"],["0.875","rgba(129,15,124,1)"],["0.916666666666667","rgba(111,8,107,1)"],["0.958333333333333","rgba(94,3,91,1)"],["1","rgba(77,0,75,1)"]],"showscale":true,"x":["00","00","00","00","00","00","00","01","01","01","01","01","01","01","02","02","02","02","02","02","02","03","03","03","03","03","03","04","04","04","04","04","04","04","05","05","05","05","05","05","05","06","06","06","06","06","06","06","07","07","07","07","07","07","07","08","08","08","08","08","08","08","09","09","09","09","09","09","09","10","10","10","10","10","10","10","11","11","11","11","11","11","11","12","12","12","12","12","12","12","13","13","13","13","13","13","13","14","14","14","14","14","14","14","15","15","15","15","15","15","15","16","16","16","16","16","16","16","17","17","17","17","17","17","17","18","18","18","18","18","18","18","19","19","19","19","19","19","19","20","20","20","20","20","20","20","21","21","21","21","21","21","21","22","22","22","22","22","22","22","23","23","23","23","23","23","23"],"y":["Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday"],"z":[25,29,26,34,18,17,21,8,14,13,6,3,3,4,8,9,5,7,8,3,3,5,9,3,3,3,2,7,7,2,3,6,1,4,7,7,2,6,1,3,6,3,1,13,11,14,8,6,6,4,21,18,23,17,12,7,10,22,25,38,33,35,14,16,38,31,24,31,32,21,26,22,31,27,32,22,26,30,32,23,31,24,34,32,39,35,29,39,31,33,54,43,42,28,41,34,39,58,54,47,39,42,32,37,44,43,40,46,43,41,34,52,47,56,49,45,59,58,53,36,61,59,52,72,58,46,41,47,46,59,53,53,54,34,47,45,48,49,44,43,38,51,39,41,40,37,38,49,33,27,33,40,33,26,40,32,32,25,28,41,11,25,25,25,19,16,20],"type":"heatmap","xaxis":"x","yaxis":"y","frame":null},{"colorbar":{"title":"COVID","ticklen":2,"len":0.333333333333333,"lenmode":"fraction","y":0.5,"yanchor":"top","x":1},"colorscale":[["0","rgba(255,255,229,1)"],["0.0416666666666667","rgba(253,254,214,1)"],["0.0833333333333333","rgba(250,253,200,1)"],["0.125","rgba(247,252,185,1)"],["0.166666666666667","rgba(237,248,178,1)"],["0.208333333333333","rgba(227,244,170,1)"],["0.25","rgba(217,240,163,1)"],["0.291666666666667","rgba(202,234,156,1)"],["0.333333333333333","rgba(188,227,149,1)"],["0.375","rgba(173,221,142,1)"],["0.416666666666667","rgba(156,213,135,1)"],["0.458333333333333","rgba(138,206,128,1)"],["0.5","rgba(120,198,121,1)"],["0.541666666666667","rgba(103,189,112,1)"],["0.583333333333333","rgba(85,180,102,1)"],["0.625","rgba(65,171,93,1)"],["0.666666666666667","rgba(55,158,84,1)"],["0.708333333333333","rgba(45,145,76,1)"],["0.75","rgba(35,132,67,1)"],["0.791666666666667","rgba(26,123,63,1)"],["0.833333333333333","rgba(14,113,59,1)"],["0.875","rgba(0,104,55,1)"],["0.916666666666667","rgba(0,92,50,1)"],["0.958333333333333","rgba(0,80,46,1)"],["1","rgba(0,69,41,1)"]],"showscale":true,"x":["00","00","00","00","00","00","00","01","01","01","01","01","02","02","02","02","02","02","03","03","03","03","03","03","03","04","04","05","05","05","05","05","05","06","06","06","06","06","06","06","07","07","07","07","07","07","07","08","08","08","08","08","08","08","09","09","09","09","09","09","09","10","10","10","10","10","10","10","11","11","11","11","11","11","11","12","12","12","12","12","12","12","13","13","13","13","13","13","13","14","14","14","14","14","14","14","15","15","15","15","15","15","15","16","16","16","16","16","16","16","17","17","17","17","17","17","17","18","18","18","18","18","18","18","19","19","19","19","19","19","19","20","20","20","20","20","20","20","21","21","21","21","21","21","21","22","22","22","22","22","22","22","23","23","23","23","23","23","23"],"y":["Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Friday","Sunday","Saturday","Friday","Thursday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday"],"z":[3,4,7,6,8,3,6,7,1,3,2,2,3,2,4,2,2,3,6,2,2,1,1,2,1,4,1,2,2,2,1,2,2,1,1,3,3,1,4,2,2,3,5,7,3,1,4,2,5,5,9,9,9,4,3,3,6,2,6,6,5,5,5,8,9,4,5,4,6,11,10,7,6,4,4,8,6,8,14,6,6,12,14,10,13,13,12,6,7,16,15,11,6,8,7,6,5,14,16,9,13,10,8,18,21,17,15,18,14,17,10,15,18,22,30,18,14,11,16,20,14,13,14,19,11,13,13,17,15,17,9,12,14,8,15,9,15,9,8,12,10,12,7,12,13,8,12,7,8,14,4,2,7,9,7,5,3,2,8],"type":"heatmap","xaxis":"x2","yaxis":"y2","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"type":"category","categoryorder":"array","categoryarray":["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"],"anchor":"y"},"xaxis2":{"domain":[0,1],"automargin":true,"type":"category","categoryorder":"array","categoryarray":["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"],"anchor":"y2"},"yaxis2":{"domain":[0,0.45],"automargin":true,"type":"category","categoryorder":"array","categoryarray":["Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday"],"anchor":"x2"},"yaxis":{"domain":[0.55,1],"automargin":true,"type":"category","categoryorder":"array","categoryarray":["Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday"],"anchor":"x"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"zaxis":{"title":"collisions"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.333333333333333},"title":"Heat Maps of Bike Crashes Involving Cyclist Factors"},"attrs":{"45910e92ae5":{"x":{},"y":{},"z":{},"colors":"BuPu","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"heatmap"},"4593bff290f":{"x":{},"y":{},"z":{},"colors":"YlGn","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"heatmap"}},"source":"A","config":{"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>Similar to the prior heat maps, crashes with a contributing factor attributed to the cyclist were clustered in the evening hours.</p>
<p><br></br></p>
</div>
<div id="heat-maps-for-crashes-invovling-driver-inattention-or-distraction" class="section level3">
<h3>Heat Maps for Crashes Invovling Driver Inattention or Distraction</h3>
<p>We next explored clustering by time of day and day of week based on whether the crash had a contributing factor of driver inattention, which showed an increase in prevalence during COVID.</p>
<pre class="r"><code>day_time_drive_err = 
  bikes %&gt;%
  pivot_longer(
    contributing_factor_vehicle_1:contributing_factor_vehicle_5,
    names_to = &quot;vehicle_factor_num&quot;,
    names_prefix = &quot;contributing_factor_vehicle_&quot;,
    values_to = &quot;contributing_factor&quot;
   ) %&gt;%
  filter(
    contributing_factor == &quot;Driver Inattention/Distraction&quot;
    ) %&gt;%
  group_by(covid, hour, dow) %&gt;%
  summarise(
    collisions = n_distinct(collision_id)
  ) 

heat_maps(dataset = day_time_drive_err, title = &quot;Heat Maps of Bike Crashes Involving Driver Inattention&quot;)</code></pre>
<div id="htmlwidget-80cf084517f69aa0c5a0" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-80cf084517f69aa0c5a0">{"x":{"data":[{"colorbar":{"title":"Pre-COVID","ticklen":2,"len":0.333333333333333,"lenmode":"fraction","y":1,"yanchor":"top","x":1},"colorscale":[["0","rgba(247,252,253,1)"],["0.0416666666666667","rgba(239,247,250,1)"],["0.0833333333333333","rgba(232,241,247,1)"],["0.125","rgba(224,236,244,1)"],["0.166666666666667","rgba(213,228,239,1)"],["0.208333333333333","rgba(202,219,235,1)"],["0.25","rgba(191,211,230,1)"],["0.291666666666667","rgba(180,203,226,1)"],["0.333333333333333","rgba(169,196,222,1)"],["0.375","rgba(158,188,218,1)"],["0.416666666666667","rgba(152,175,211,1)"],["0.458333333333333","rgba(146,163,205,1)"],["0.5","rgba(140,150,198,1)"],["0.541666666666667","rgba(141,136,191,1)"],["0.583333333333333","rgba(141,122,184,1)"],["0.625","rgba(140,107,177,1)"],["0.666666666666667","rgba(139,94,170,1)"],["0.708333333333333","rgba(138,80,164,1)"],["0.75","rgba(136,65,157,1)"],["0.791666666666667","rgba(134,52,146,1)"],["0.833333333333333","rgba(132,36,135,1)"],["0.875","rgba(129,15,124,1)"],["0.916666666666667","rgba(111,8,107,1)"],["0.958333333333333","rgba(94,3,91,1)"],["1","rgba(77,0,75,1)"]],"showscale":true,"x":["00","00","00","00","00","00","00","01","01","01","01","01","01","01","02","02","02","02","02","02","02","03","03","03","03","03","04","04","04","04","04","04","04","05","05","05","05","05","05","06","06","06","06","06","06","07","07","07","07","07","07","07","08","08","08","08","08","08","08","09","09","09","09","09","09","09","10","10","10","10","10","10","10","11","11","11","11","11","11","11","12","12","12","12","12","12","12","13","13","13","13","13","13","13","14","14","14","14","14","14","14","15","15","15","15","15","15","15","16","16","16","16","16","16","16","17","17","17","17","17","17","17","18","18","18","18","18","18","18","19","19","19","19","19","19","19","20","20","20","20","20","20","20","21","21","21","21","21","21","21","22","22","22","22","22","22","22","23","23","23","23","23","23","23"],"y":["Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Tuesday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Tuesday","Monday","Sunday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday"],"z":[17,21,18,23,13,13,14,5,6,8,4,1,4,1,4,6,5,6,6,1,1,2,4,3,2,1,4,5,1,2,6,1,3,3,3,3,4,3,4,2,6,9,7,5,5,4,7,12,15,17,14,3,6,10,19,23,25,27,22,6,16,22,19,22,31,18,17,21,14,18,13,20,17,13,22,23,31,24,20,18,22,27,23,24,25,22,27,31,31,33,20,28,22,21,39,43,44,39,31,25,29,22,29,37,35,37,31,27,49,26,40,31,40,50,42,28,33,46,46,47,53,41,35,39,37,39,43,37,38,38,30,25,33,36,38,25,38,28,35,34,32,33,28,30,29,27,30,35,36,23,23,24,29,33,17,23,26,9,21,17,19,18,8,6],"type":"heatmap","xaxis":"x","yaxis":"y","frame":null},{"colorbar":{"title":"COVID","ticklen":2,"len":0.333333333333333,"lenmode":"fraction","y":0.5,"yanchor":"top","x":1},"colorscale":[["0","rgba(255,255,229,1)"],["0.0416666666666667","rgba(253,254,214,1)"],["0.0833333333333333","rgba(250,253,200,1)"],["0.125","rgba(247,252,185,1)"],["0.166666666666667","rgba(237,248,178,1)"],["0.208333333333333","rgba(227,244,170,1)"],["0.25","rgba(217,240,163,1)"],["0.291666666666667","rgba(202,234,156,1)"],["0.333333333333333","rgba(188,227,149,1)"],["0.375","rgba(173,221,142,1)"],["0.416666666666667","rgba(156,213,135,1)"],["0.458333333333333","rgba(138,206,128,1)"],["0.5","rgba(120,198,121,1)"],["0.541666666666667","rgba(103,189,112,1)"],["0.583333333333333","rgba(85,180,102,1)"],["0.625","rgba(65,171,93,1)"],["0.666666666666667","rgba(55,158,84,1)"],["0.708333333333333","rgba(45,145,76,1)"],["0.75","rgba(35,132,67,1)"],["0.791666666666667","rgba(26,123,63,1)"],["0.833333333333333","rgba(14,113,59,1)"],["0.875","rgba(0,104,55,1)"],["0.916666666666667","rgba(0,92,50,1)"],["0.958333333333333","rgba(0,80,46,1)"],["1","rgba(0,69,41,1)"]],"showscale":true,"x":["00","00","00","00","00","00","00","01","01","01","02","02","02","02","02","03","03","03","03","03","03","04","04","05","05","06","06","06","06","06","06","06","07","07","07","07","07","07","07","08","08","08","08","08","08","08","09","09","09","09","09","09","09","10","10","10","10","10","10","10","11","11","11","11","11","11","11","12","12","12","12","12","12","12","13","13","13","13","13","13","13","14","14","14","14","14","14","14","15","15","15","15","15","15","15","16","16","16","16","16","16","16","17","17","17","17","17","17","17","18","18","18","18","18","18","18","19","19","19","19","19","19","19","20","20","20","20","20","20","20","21","21","21","21","21","21","21","22","22","22","22","22","22","22","23","23","23","23","23","23","23"],"y":["Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Friday","Thursday","Sunday","Saturday","Friday","Wednesday","Tuesday","Sunday","Saturday","Thursday","Wednesday","Tuesday","Monday","Sunday","Thursday","Friday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday"],"z":[8,6,4,5,2,5,6,3,1,3,5,1,3,1,1,6,1,1,1,1,1,2,1,3,3,2,2,4,3,3,5,3,2,1,4,4,4,3,3,4,2,6,8,9,8,4,5,2,4,4,8,6,4,2,7,5,3,2,5,3,7,10,4,6,2,8,5,9,5,4,14,8,9,13,13,10,11,13,7,6,5,8,11,11,5,6,8,5,7,8,15,7,8,7,11,13,23,17,19,18,14,16,10,10,18,19,19,12,20,12,12,16,20,13,15,18,9,12,10,12,14,22,11,15,9,10,7,7,21,10,9,11,6,9,5,9,9,9,7,6,6,8,4,2,6,8,7,6,6,1,6],"type":"heatmap","xaxis":"x2","yaxis":"y2","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"type":"category","categoryorder":"array","categoryarray":["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"],"anchor":"y"},"xaxis2":{"domain":[0,1],"automargin":true,"type":"category","categoryorder":"array","categoryarray":["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"],"anchor":"y2"},"yaxis2":{"domain":[0,0.45],"automargin":true,"type":"category","categoryorder":"array","categoryarray":["Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday"],"anchor":"x2"},"yaxis":{"domain":[0.55,1],"automargin":true,"type":"category","categoryorder":"array","categoryarray":["Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday"],"anchor":"x"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"zaxis":{"title":"collisions"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.333333333333333},"title":"Heat Maps of Bike Crashes Involving Driver Inattention"},"attrs":{"45914f15c7a":{"x":{},"y":{},"z":{},"colors":"BuPu","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"heatmap"},"45971ee5853":{"x":{},"y":{},"z":{},"colors":"YlGn","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"heatmap"}},"source":"A","config":{"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>Again, there was a similar trend pre- and during COVID, where the majority of bike crashes are clustered in the evening hours, with slightly more clustering in the evening rush hour times of 4-6 PM during COVID.</p>
<p><br></br></p>
</div>
</div>
<div id="temporal-heat-maps-for-microvehicle-crashes" class="section level2">
<h2>Temporal Heat Maps for Microvehicle Crashes</h2>
<p>Finally, we created a heat map of microvehicle crashes involving an injury by time of day and day of week pre and during COVID.</p>
<pre class="r"><code>micro_day_time = 
  microveh %&gt;%
  group_by(covid, hour, dow) %&gt;%
  summarise(
    collisions = n_distinct(collision_id)
  ) 

heat_maps(dataset = micro_day_time, title = &quot;Heat Maps of Microvehicle Crashes&quot;)</code></pre>
<div id="htmlwidget-00c719a43119668bfc16" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-00c719a43119668bfc16">{"x":{"data":[{"colorbar":{"title":"Pre-COVID","ticklen":2,"len":0.333333333333333,"lenmode":"fraction","y":1,"yanchor":"top","x":1},"colorscale":[["0","rgba(247,252,253,1)"],["0.0416666666666667","rgba(239,247,250,1)"],["0.0833333333333333","rgba(232,241,247,1)"],["0.125","rgba(224,236,244,1)"],["0.166666666666667","rgba(213,228,239,1)"],["0.208333333333333","rgba(202,219,235,1)"],["0.25","rgba(191,211,230,1)"],["0.291666666666667","rgba(180,203,226,1)"],["0.333333333333333","rgba(169,196,222,1)"],["0.375","rgba(158,188,218,1)"],["0.416666666666667","rgba(152,175,211,1)"],["0.458333333333333","rgba(146,163,205,1)"],["0.5","rgba(140,150,198,1)"],["0.541666666666667","rgba(141,136,191,1)"],["0.583333333333333","rgba(141,122,184,1)"],["0.625","rgba(140,107,177,1)"],["0.666666666666667","rgba(139,94,170,1)"],["0.708333333333333","rgba(138,80,164,1)"],["0.75","rgba(136,65,157,1)"],["0.791666666666667","rgba(134,52,146,1)"],["0.833333333333333","rgba(132,36,135,1)"],["0.875","rgba(129,15,124,1)"],["0.916666666666667","rgba(111,8,107,1)"],["0.958333333333333","rgba(94,3,91,1)"],["1","rgba(77,0,75,1)"]],"showscale":true,"x":["00","00","00","00","00","00","00","01","01","01","01","01","02","02","03","04","04","04","04","05","05","05","06","06","06","06","06","06","07","07","07","07","07","08","08","08","08","08","08","08","09","09","09","09","09","09","10","10","10","10","10","10","11","11","11","11","11","11","11","12","12","12","12","12","12","12","13","13","13","13","13","13","13","14","14","14","14","14","14","14","15","15","15","15","15","15","15","16","16","16","16","16","16","16","17","17","17","17","17","17","17","18","18","18","18","18","18","18","19","19","19","19","19","19","19","20","20","20","20","20","20","20","21","21","21","21","21","21","21","22","22","22","22","22","22","22","23","23","23","23","23","23","23"],"y":["Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Saturday","Monday","Sunday","Sunday","Friday","Thursday","Tuesday","Saturday","Friday","Wednesday","Sunday","Friday","Thursday","Wednesday","Tuesday","Monday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday"],"z":[4,4,2,3,3,1,1,2,3,1,1,1,1,1,1,1,1,1,1,1,1,2,1,2,4,2,2,1,1,3,3,1,2,2,3,7,1,6,1,1,1,4,3,3,7,1,2,1,3,2,4,1,3,4,5,3,1,2,1,5,4,3,5,4,6,4,3,2,6,7,7,6,1,2,5,1,2,2,5,2,4,4,4,9,14,7,5,2,5,4,3,9,10,5,1,4,5,7,10,5,10,5,4,5,10,1,6,6,8,6,8,8,8,3,7,7,7,7,3,2,8,3,4,6,3,2,3,2,5,3,3,10,3,4,1,6,3,3,4,4,4,1,1],"type":"heatmap","xaxis":"x","yaxis":"y","frame":null},{"colorbar":{"title":"COVID","ticklen":2,"len":0.333333333333333,"lenmode":"fraction","y":0.5,"yanchor":"top","x":1},"colorscale":[["0","rgba(255,255,229,1)"],["0.0416666666666667","rgba(253,254,214,1)"],["0.0833333333333333","rgba(250,253,200,1)"],["0.125","rgba(247,252,185,1)"],["0.166666666666667","rgba(237,248,178,1)"],["0.208333333333333","rgba(227,244,170,1)"],["0.25","rgba(217,240,163,1)"],["0.291666666666667","rgba(202,234,156,1)"],["0.333333333333333","rgba(188,227,149,1)"],["0.375","rgba(173,221,142,1)"],["0.416666666666667","rgba(156,213,135,1)"],["0.458333333333333","rgba(138,206,128,1)"],["0.5","rgba(120,198,121,1)"],["0.541666666666667","rgba(103,189,112,1)"],["0.583333333333333","rgba(85,180,102,1)"],["0.625","rgba(65,171,93,1)"],["0.666666666666667","rgba(55,158,84,1)"],["0.708333333333333","rgba(45,145,76,1)"],["0.75","rgba(35,132,67,1)"],["0.791666666666667","rgba(26,123,63,1)"],["0.833333333333333","rgba(14,113,59,1)"],["0.875","rgba(0,104,55,1)"],["0.916666666666667","rgba(0,92,50,1)"],["0.958333333333333","rgba(0,80,46,1)"],["1","rgba(0,69,41,1)"]],"showscale":true,"x":["00","00","00","00","00","00","00","01","01","01","01","01","01","01","02","02","02","02","02","02","02","03","03","03","03","03","03","03","04","04","04","04","04","05","05","05","05","05","06","06","06","06","06","06","06","07","07","07","07","07","08","08","08","08","08","08","08","09","09","09","09","09","09","09","10","10","10","10","10","10","10","11","11","11","11","11","11","11","12","12","12","12","12","12","12","13","13","13","13","13","13","13","14","14","14","14","14","14","14","15","15","15","15","15","15","15","16","16","16","16","16","16","16","17","17","17","17","17","17","17","18","18","18","18","18","18","18","19","19","19","19","19","19","19","20","20","20","20","20","20","20","21","21","21","21","21","21","21","22","22","22","22","22","22","22","23","23","23","23","23","23","23"],"y":["Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Wednesday","Tuesday","Sunday","Saturday","Thursday","Wednesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Friday","Thursday","Wednesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday"],"z":[12,7,6,5,8,7,5,4,5,4,2,3,2,1,3,3,2,3,2,4,4,4,1,2,3,1,2,1,2,2,1,1,3,1,2,2,1,3,4,1,1,1,1,1,3,2,4,3,2,4,3,5,3,4,6,5,2,4,3,3,4,6,7,8,4,1,4,3,3,8,4,5,5,7,2,8,1,5,9,10,14,14,9,6,4,6,11,15,19,6,10,13,9,8,16,14,9,17,12,6,5,18,7,9,11,13,9,10,13,15,14,10,9,7,15,15,15,20,15,17,12,10,12,13,16,14,10,12,20,13,10,14,11,7,14,10,17,12,8,8,11,7,12,14,10,10,8,6,9,7,8,6,11,10,1,3,11,10,6,8,6,11],"type":"heatmap","xaxis":"x2","yaxis":"y2","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"type":"category","categoryorder":"array","categoryarray":["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"],"anchor":"y"},"xaxis2":{"domain":[0,1],"automargin":true,"type":"category","categoryorder":"array","categoryarray":["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"],"anchor":"y2"},"yaxis2":{"domain":[0,0.45],"automargin":true,"type":"category","categoryorder":"array","categoryarray":["Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday"],"anchor":"x2"},"yaxis":{"domain":[0.55,1],"automargin":true,"type":"category","categoryorder":"array","categoryarray":["Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday"],"anchor":"x"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"zaxis":{"title":"collisions"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.333333333333333},"title":"Heat Maps of Microvehicle Crashes"},"attrs":{"45955c26e1f":{"x":{},"y":{},"z":{},"colors":"BuPu","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"heatmap"},"4594fcbe135":{"x":{},"y":{},"z":{},"colors":"YlGn","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"heatmap"}},"source":"A","config":{"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>As compared to the heat maps for bike crashes, the heat maps for microvehicle crashes showed a wider clustering pattern on weekdays through the afternoon and evening hours during COVID.</p>
<p><br></br></p>
</div>
<div id="summary-of-findings" class="section level2">
<h2>Summary of Findings</h2>
<p>As we expected, there were slight differences in the patterns of contributing factors for bike crashes involving cyclist injuries. More crashes had a contributing factor of driver inattention, which may be related to increased unsafe driving habits during the pandemic. Contrary to what was expected, a lower proportion of crashes had a contributing factor of cyclist error. Those who biked during the pandemic may have been more experienced or safer riders than those who biked pre-pandemic. In addition, bike crashes showed increased clustering during evening commute hours during the pandemic, which was not originally expected. However, this may indicate that these individuals were more likely to be using biking as a mode of commuting during the pandemic as compared to more individuals using biking as a form of recreation pre-pandemic.</p>
<p>Microvehicle crashes showed similar patterns in contributing factors pre- and during COVID.Microvehicle crashes showed less clustering during the evening commute hours as compared to bike crashes. This could indicate that individuals who crash a microhevicle may be more likely to be using these devices for recreational purposes as opposed to commuting purposes. As there were few microvehicle crashes prior to 2020, it is more difficult to assess changes in these patterns due to COVID.</p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
